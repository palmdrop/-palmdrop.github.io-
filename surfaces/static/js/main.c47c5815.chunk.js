(this.webpackJsonpsurfaces=this.webpackJsonpsurfaces||[]).push([[0],{100:function(e,t,n){},101:function(e,t,n){},102:function(e,t,n){},103:function(e,t,n){},104:function(e,t,n){},105:function(e,t,n){"use strict";n.r(t);var i=n(3),r=n.n(i),a=n(29),o=n.n(a),s=(n(64),n(10)),l=n(1),c=n(2),u=n(8),h=n(7),f=n(4),d=n(5),m=function(e){return e[Math.floor(Math.random()*e.length)]},p=function(e){return{value:{frequency:{value:.4*Math.random()+.25,default:1,min:1e-7,max:2,type:"1f",description:"Speed of change across space"},octaves:{value:m([3,5]),default:3,type:"1i",min:1,max:5,step:2,marks:[1,3,5],description:"Number of noise layers"},lacunarity:{value:6*Math.random()+2,default:2,type:"1f",min:.1,max:10,description:"Frequency multiplier for each layer"},persistence:{value:.3*Math.random(),default:.5,type:"1f",min:.1,max:5,description:"Amplitude multiplier for each layer"},amplitude:{value:1,default:1,type:"1f",min:.1,max:10,description:"The strength (height) of the noise"},modifications:{value:{ridgeThreshold:{value:1-Math.pow(Math.random(),2),default:1,type:"1f",min:.5,max:1,description:"The smoothness/sharpness of the noise peaks (low values sharpens the peaks)"},pow:{value:2*Math.random()+1,default:1,type:"1f",min:-1,max:5,description:"Applies a power operator to the noise"},mod:{value:1,default:1,type:"1f",min:1,max:5,description:"Applies a modulus operator to the noise"},xStretch:{value:1,default:1,type:"1f",min:.001,max:10,description:"Stretches the noise in the X direction"},yStretch:{value:1,default:1,type:"1f",min:.001,max:10,description:"Stretches the noise in the Y direction"}},description:"Various modifications that can be applied to the noise"}},isUniform:!0,description:e}},g=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{value:e,default:n||e,min:0,max:1,description:t}},v=function(){return{scale:{value:2*Math.random()+2,default:1,isUniform:!0,type:"1f",min:.001,max:10,actualMax:1e3,description:"Zooms the entire texture (can also be controlled using the mouse wheel)"},iterations:{value:m([1,2,3]),default:2,isUniform:!0,type:"1i",min:0,max:4,description:"Number of domain warping steps/iterations"},warpAmount:{value:1*Math.random()+.5,default:1,isUniform:!0,type:"1f",min:0,max:5,description:"Strength/amount of the domain warping effect"},animationSpeed:{value:{general:g(.05,"General animation speed"),source:g(1,"Animation speed for the source layer"),angleControl:g(1,"Animation speed for the angle layer"),amountControl:g(1,"Animation speed for the amount layer")},description:"Controllers for animation speed of the entire animation and the three layers separately",isUniform:!1},source:p("Noise controller for the source pattern: the domain warp effect is applied to this noise"),angleControl:p("Noise controller for angle pattern: this controls the angle/rotation of the domain warp at a given point"),amountControl:p("Noise controller for amount pattern: this controls the intensity of the domain warp at a given point")}},b=function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1,1];return{value:{mult:{value:0,default:0,type:"1i",min:0,max:1,description:"If activated, the three components will be multiplied together instead of summed"},source:{value:e,default:r[0],type:"1f",min:-1,max:1,description:"The influence of the source pattern"},angle:{value:t,default:r[1],type:"1f",min:-1,max:1,description:"The influence of the angle pattern"},amount:{value:n,default:r[2],type:"1f",min:-1,max:1,description:"The influence of the amount pattern"}},description:i,isUniform:!0}},x=function(){return{power:{value:1,default:1,isUniform:!0,type:"1f",min:.001,max:10,description:"Applies a power operator to the brightness of the color"},general:{value:{hue:{value:Math.random(),default:0,type:"1f",min:-.5,max:.5,description:"Hue shift of the output color"},saturation:{value:.5*Math.random()+.5,default:.7,isUniform:!0,type:"1f",min:.001,max:10,description:"Saturation of the output color"},brightness:{value:1,default:1,isUniform:!0,type:"1f",min:.001,max:4,description:"Brightness of the output color"},red:{value:1,default:1,isUniform:!0,type:"1f",min:.001,max:4,description:"Multiplier applied to the red channel of the output color"},green:{value:1,default:1,isUniform:!0,type:"1f",min:.001,max:4,description:"Multiplier applied to the green channel of the output color"},blue:{value:1,default:1,isUniform:!0,type:"1f",min:.001,max:4,description:"Multiplier applied to the blue channel of the output color"}},description:"General color settings",isUniform:!0},hueController:b(1*Math.random()-.5,1*Math.random()-.5,1*Math.random()-.5,"Controls how the three layers influence the hue of the output color",[1,1,0]),saturationController:b(1*Math.random(),1*Math.random(),1*Math.random(),"Controls how the three layers influence the saturation of the output color",[0,1,-.5]),brightnessController:b(1,0,0,"Controls how the three layers influence the brightness of the output color",[1,0,0])}},y=function(){return{resolution:{value:1,default:1,isUniform:!1,type:"1f",min:.1,max:3,description:"Multiplier for the width and height of the canvas"},ditheringAmount:{value:1/255,default:1/255,isUniform:!1,min:0,max:.2,description:"Applies dithering (blue noise) to the final color"},multisampling:{value:0,default:0,isUniform:!1,type:"1i",min:0,max:1,description:"Activates multisampling: will use four samples per pixel instead of one"}}},j=function(e,t){var n=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i=t.split(".");if(n(e,i[0])){for(var r=e[i[0]],a=1;a<i.length;a++){if("object"!==typeof r)return;if(!n(r.value,i[a]))return;r=r.value[i[a]]}return[e[i[0]].isUniform,r]}},C=function(e,t,n){var i=function(e,i){if(e.isUniform){!function e(i,r){if("object"===typeof i.value)for(var a in i.value)Object.prototype.hasOwnProperty.call(i.value,a)&&e(i.value[a],r+"."+a);else n.setUniform(t,r,i.type,i.value)}(e,i)}};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&i(e[r],r)},w=function(e,t,n){var i=function e(i){if(!n||!n(i))if("object"===typeof i.value)for(var r in i.value)Object.prototype.hasOwnProperty.call(i.value,r)&&e(i.value[r]);else t(i)};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&i(e[r]);return e},O=function(e){return w(e,(function(e){return e.value=e.default}))},k=function e(t,n){if("object"!==typeof t||Array.isArray(t))return n||t;if(!n)return t;var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=e(t[r],n[r]));return i},_=function(){function e(t){Object(l.a)(this,e),this._attributeGetter=t,this.attributes=this._attributeGetter(),this.program=null,this.GLC=null}return Object(c.a)(e,[{key:"updateValue",value:function(e,t){return function(e,t,n,i,r){var a=j(e,n),o=Object(s.a)(a,2),l=o[0],c=o[1];return"undefined"!==typeof c&&(c.actualMax&&i>c.actualMax&&(i=c.actualMax),c.value!==i&&(c.value=i,l&&t&&r&&r.setUniform(t,n,c.type,c.value),"function"===typeof c.onChange&&c.onChange(i),!0))}(this.attributes,this.program,e,t,this.GLC)}},{key:"getValue",value:function(e){return function(e,t){var n=j(e,t),i=Object(s.a)(n,2)[1];if("undefined"!==typeof i)return i.value}(this.attributes,e)}},{key:"getDefault",value:function(e){return function(e,t){var n=j(e,t),i=Object(s.a)(n,2)[1];if("undefined"!==typeof i)return i.default}(this.attributes,e)}},{key:"getAttributes",value:function(){return this.attributes}},{key:"_update",value:function(){this.GLC&&this.program&&C(this.attributes,this.program,this.GLC),w(this.attributes,(function(e){e.onChange&&e.onChange(e.value)}))}},{key:"setAttributes",value:function(e){this.attributes=e,this._update()}},{key:"reset",value:function(){this.attributes=O(this.attributes),this._update()}},{key:"randomize",value:function(){this.attributes=this._attributeGetter(),this._update()}}]),e}(),T=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(l.a)(this,n);var i=function(){return[1e3*Math.random(),1e3*Math.random(),1]};return(e=t.call(this,v)).canvas=null,e.GLC=null,e.initialized=!1,e.program=null,e.sourceOffset=i(),e.angleOffset=i(),e.amountOffset=i(),e.position=[0,0],e.dimensions=[window.innerWidth,window.innerHeight],e.paused=!1,e.sourceTime=0,e.angleControlTime=0,e.amountControlTime=0,e.previousResolution=1,e.multisamplingMultiplier=2,e.multisamplingDimensions=[-1,-1],e.fbo=-1,e}return Object(c.a)(n,[{key:"isInitialized",value:function(){return this.initialized}},{key:"initialize",value:function(e,t,n){return this.initialized?(console.log("The texture controller is already initialized"),!0):(console.log("Initializing texture controller"),this.GLC=n,this.canvas=e,console.log("Compiling shaders"),this.program=t,console.log("Setting uniforms"),this.GLC.setShaderProgram(this.program),this._update(),console.log("Done initializing texture controller"),this.initialized=!0,!0)}},{key:"_setupFramebuffer",value:function(){var e=this;this.renderTexture&&(this.GLC.deleteTexture(this.renderTexture),this.GLC.deleteFramebuffer(this.fbo)),this.multisamplingDimensions=[this.dimensions[0]*this.multisamplingMultiplier,this.dimensions[1]*this.multisamplingMultiplier];var t=function(t,n){var i=e.GLC.getGL();return e.GLC.createTexture(t,n,i.RGBA,i.RGBA32F,i.FLOAT)};this.renderTexture=this.getValue("multisampling")?t(this.multisamplingDimensions[0],this.multisamplingDimensions[1]):t(this.dimensions[0],this.dimensions[1]),this.fbo=this.GLC.createFramebuffer(this.renderTexture)}},{key:"getDimensions",value:function(){return this.dimensions}},{key:"getPosition",value:function(){return this.position}},{key:"updateValue",value:function(e,t){var i=Object(u.a)(Object(h.a)(n.prototype),"updateValue",this).call(this,e,t);return"multisampling"===e&&this._handleUpdate(!0),i}},{key:"setPosition",value:function(e){this.initialized&&(this.position[0]=e[0],this.position[1]=e[1],this.GLC.setShaderProgram(this.program),this.GLC.setUniform(this.program,"position","2fv",e))}},{key:"setPaused",value:function(e){this.paused=e}},{key:"render",value:function(e,t,n){var i=this.GLC;if(i.setShaderProgram(this.program),!this.paused){var r=this.getValue("animationSpeed.general");this.sourceTime+=r*this.getValue("animationSpeed.source")*n,this.angleControlTime+=r*this.getValue("animationSpeed.angleControl")*n,this.amountControlTime+=r*this.getValue("animationSpeed.amountControl")*n}return i.setUniform(this.program,"source.offset","3fv",[this.sourceOffset[0],this.sourceOffset[1],this.sourceTime]),i.setUniform(this.program,"angleControl.offset","3fv",[this.angleOffset[0],this.angleOffset[1],this.angleControlTime]),i.setUniform(this.program,"amountControl.offset","3fv",[this.amountOffset[0],this.amountOffset[1],this.amountControlTime]),i.bindFramebuffer(e),i.setViewport(t[0],t[1]),i.setUniform(this.program,"viewport","2fv",t),i.renderFullScreenQuad(this.program),this.renderTexture}}]),n}(_),R=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this,x)).canvas=null,e.GLC=null,e.initialized=!1,e.program=null,e.ditheringTexture=null,e.captureNext=!1,e.dataCallback=null,e.time=0,e}return Object(c.a)(n,[{key:"captureFrame",value:function(e){this.captureNext=!0,this.dataCallback=e}},{key:"initialize",value:function(e,t,n,i){var r=this;return this.initialized?(console.log("The color controller is already initialized"),!0):(console.log("Initializing color controller"),this.GLC=n,this.canvas=e,this.program=t,this.GLC.setShaderProgram(this.program),C(this.attributes,this.program,this.GLC),this.ditheringTexture=this.GLC.createImageTexture(i,this.GLC.getGL().REPEAT,this.GLC.getGL().NEAREST,(function(e,t){r.GLC.setUniform(r.program,"hasDitheringTexture","1i",1),r.GLC.setTexture(r.ditheringTexture,1),r.GLC.setUniform(r.program,"ditheringTexture","1i",1),r.GLC.setUniform(r.program,"ditheringTextureDimensions","2fv",[e,t])}),(function(){console.error("Dithering texture failed to load")})),this.initialized=!0,!0)}},{key:"isInitialized",value:function(){return this.initialized}},{key:"render",value:function(e,t,n,i,r){this.time+=r;var a=this.GLC;if(a.bindFramebuffer(null),a.setViewport(t[0],t[1]),this.GLC.setUniform(this.program,"viewport","2fv",t),this.GLC.setUniform(this.program,"time","1f",this.time),this.GLC.setUniform(this.program,"ditheringAmount","1f",i),a.setShaderProgram(this.program),a.setTexture(e,0),a.setUniform(this.program,"texture","1i",0),a.setUniform(this.program,"multisampling","1i",n),a.renderFullScreenQuad(this.program),this.captureNext){this.captureNext=!1;var o=this.canvas.toDataURL("image/png");this.dataCallback(o)}}}]),n}(_),S=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this,y)).initialized=!1,e.dimensions=[window.innerWidth,window.innerHeight],e.previousResolution=1,e.resolution=1,e.canvas=null,e.resizeCallback=null,e.multisamplingMultiplier=2,e.multisamplingDimensions=[-1,-1],e.fbo=null,e.renderTexture=null,e.initialized=!1,e}return Object(c.a)(n,[{key:"initialize",value:function(e,t){return this.initialized?(console.log("The render controller is already initialized"),!0):(this.canvas=e,this.GLC=t,this._handleUpdate(!0),this.initialized=!0,!0)}},{key:"_setupFramebuffer",value:function(){var e=this;this.renderTexture&&(this.GLC.deleteTexture(this.renderTexture),this.GLC.deleteFramebuffer(this.fbo)),this.multisamplingDimensions=[this.dimensions[0]*this.multisamplingMultiplier,this.dimensions[1]*this.multisamplingMultiplier];var t=function(t,n){var i=e.GLC.getGL();return e.GLC.floatColorBufferSupported()?e.GLC.createTexture(t,n,i.RGBA,i.RGBA32F,i.FLOAT):e.GLC.createTexture(t,n,i.RGBA,i.RGBA8,i.UNSINGED_BYTE)};this.renderTexture=this.getValue("multisampling")?t(this.multisamplingDimensions[0],this.multisamplingDimensions[1]):t(this.dimensions[0],this.dimensions[1]),this.fbo=this.GLC.createFramebuffer(this.renderTexture)}},{key:"updateValue",value:function(e,t){var i=Object(u.a)(Object(h.a)(n.prototype),"updateValue",this).call(this,e,t);return"multisampling"!==e&&"resolution"!==e||this._handleUpdate(!0),i}},{key:"getDimensions",value:function(){return this.dimensions}},{key:"getRenderTextureDimensions",value:function(){return this.getValue("multisampling")?this.multisamplingDimensions:this.dimensions}},{key:"getRenderTexture",value:function(){return this.renderTexture}},{key:"getFrameBuffer",value:function(){return this.fbo}},{key:"_handleUpdate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.dimensions[0],n=this.dimensions[1],i=this.getValue("resolution"),r=i*window.innerWidth,a=i*window.innerHeight,o=[r,a];this.GLC.setViewport(r,a),this.canvas.style.width=window.innerWidth,this.canvas.style.height=window.innerHeight,this.canvas.width=r,this.canvas.height=a,this.dimensions=o,this.previousResolution=i,(e||t!==r||n!==a||i!==this.previousResolution)&&(this._setupFramebuffer(),this.resizeCallback&&this.resizeCallback(this.dimensions))}},{key:"handleResize",value:function(){this.initialized&&this._handleUpdate()}},{key:"addResizeCallback",value:function(e){e(this.dimensions);var t=this.resizeCallback;this.resizeCallback=function(n){t&&t(n),e(n)}}},{key:"screenSpaceToViewSpace",value:function(e){var t=window.innerWidth,n=window.innerHeight,i=n/t;return[e[0]/t,e[1]*i/n]}}]),n}(_),E=n(0),L=n(26),N=n(50),A=function(){function e(t,n,i,r,a){var o=this;Object(l.a)(this,e),this.renderer=t,this.camera=new E.X(-i/2,i/2,r/2,-r/2,-1e3,1e3),this.camera.position.z=100,this.scene=new E.ib,this.scene.background=new E.l("#ff0000"),this.composer=new L.b(this.renderer,{frameBufferType:E.B}),this.composer.autoRenderToScreen=!1;var s=new L.d(this.scene,this.camera);this.composer.addPass(s),a.forEach((function(e){o.composer.addPass(e)}));var c=new E.P({map:n}),u=new E.Z(1,1);this.quad=new E.O(u,c),this.quad.position.z=-100,this.quad.scale.x=i,this.quad.scale.y=r;var h=new E.c("#ffffff",5);this.scene.add(this.quad,h)}return Object(c.a)(e,[{key:"setSize",value:function(e,t){this.camera.left=-e/2,this.camera.right=e/2,this.camera.top=t/2,this.camera.bottom=-t/2,this.camera.updateProjectionMatrix(),this.composer.setSize(),this.quad.scale.x=e,this.quad.scale.y=t}},{key:"render",value:function(e){this.composer.render(e)}},{key:"getProcessedTexture",value:function(){return this.composer.outputBuffer.texture}}]),e}(),D={uniforms:{tDiffuse:{value:null},opacity:{value:1},width:{value:0},height:{value:0}},vertexShader:"\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t}",fragmentShader:"\n\t\tuniform float opacity;\n\t\tuniform sampler2D tDiffuse;\n\n\t\tuniform float width;\n\t\tuniform float height;\n\n\t\tvarying vec2 vUv;\n\n\n\t\tfloat toGray(vec4 color) {\n\t\t\treturn dot(color.rgb, vec3(0.299, 0.587, 0.114));\n\t\t}\n\n\t\tfloat smpl(float offsetX, float offsetY) {\n\t\t\treturn toGray(texture2D( tDiffuse, vUv + vec2(offsetX, offsetY)));\n\t\t}\n\n\t\tvec3 getNormal(vec2 uv) {\n\t\t\tfloat offsetX = 1.0 / width;\t\n\t\t\tfloat offsetY = 1.0 / height;\t\n\n\t\t\tfloat tx0 = toGray(texture2D( tDiffuse, uv + vec2(-offsetX, 0)));\n\t\t\tfloat tx1 = toGray(texture2D( tDiffuse, uv + vec2(offsetX, 0)));\n\n\t\t\tfloat ty0 = toGray(texture2D( tDiffuse, uv + vec2(0, -offsetX)));\n\t\t\tfloat ty1 = toGray(texture2D( tDiffuse, uv + vec2(0, offsetX)));\n\n\t\t\tvec3 normal = normalize(vec3(\n\t\t\t\t(tx0 - tx1) / (offsetX),\n\t\t\t\t(ty0 - ty1) / (offsetY),\n\t\t\t\t1\n\t\t\t));\n\n\t\t\tnormal.x += 1.0;\n\t\t\tnormal.x /= 2.0;\n\t\t\tnormal.y += 1.0;\n\t\t\tnormal.y /= 2.0;\n\t\t\tnormal.z = 1.0;\n\n\t\t\treturn normal;\n\n\t\t\t/*vec3 p1 = vec3(uv, 0.0);\n\t\t\tvec3 p2 = vec3(uv + vec2(offsetX, 0), 0.0);\n\t\t\tvec3 p3 = vec3(uv + vec2(0, offsetY), 0.0);\n\n\t\t\tp1.z = toGray(texture2D( tDiffuse, p1.xy ));\n\t\t\tp2.z = toGray(texture2D( tDiffuse, p2.xy ));\n\t\t\tp3.z = toGray(texture2D( tDiffuse, p3.xy ));\n\n\t\t\tvec3 u = p2 - p1;\n\t\t\tvec3 v = p3 - p1;\n\n\t\t\treturn normalize(vec3(\n\t\t\t\t((u.y * v.z - u.z * v.y) + 1.0) / 2.0,\n\t\t\t\t((u.z * v.x - u.x - v.z) + 1.0) / 2.0,\n\t\t\t\t((u.x * v.y - u.y * v.x) + 1.0) / 2.0\n\t\t\t));*/\n\n\t\t\t/*vec3 normal;\n\t\t\tfloat scale = 1.0 / width;\n\n\t\t\tfloat s0 = smpl(-offsetX, -offsetY);\n\t\t\tfloat s1 = smpl(0.0, -offsetY);\n\t\t\tfloat s2 = smpl(offsetX, -offsetY);\n\n\t\t\tfloat s3 = smpl(-offsetX, 0.0);\n\t\t\tfloat s4 = smpl(0.0, 0.0);\n\t\t\tfloat s5 = smpl(offsetX, 0.0);\n\n\t\t\tfloat s6 = smpl(-offsetX, offsetY);\n\t\t\tfloat s7 = smpl(0.0, offsetY);\n\t\t\tfloat s8 = smpl(offsetX, offsetY);\n\n\t\t\tnormal.x = scale * -(s2-s0+2.0*(s5-s3)+s8-s6);\n\t\t\tnormal.y = scale * -(s6-s0+2.0*(s7-s1)+s8-s2);\n\t\t\tnormal.z = 1.0;\n\n\t\t\tnormal = normalize(normal);\n\n\t\t\tnormal.x += 1.0;\n\t\t\tnormal.x /= 2.0;\n\t\t\tnormal.y += 1.0;\n\t\t\tnormal.y /= 2.0;\n\n\t\t\treturn normal;*/\n\t\t}\n\n\t\tvoid main() {\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\t//float gray = toGray(texel);\n\t\t\t//gl_FragColor = opacity * vec4(vec3(gray), texel.a);\n\t\t\tvec3 normal = getNormal( vUv );\n\t\t\tgl_FragColor = vec4(normal, texel.a);\n\t\t}"},z=n(55),G=n(51),M=function(e,t,n){var i={};return i.description=t,i.value={intensity:{value:n.intensity,default:n.intensity,min:0,max:15,onChange:function(t){e().intensity=t},description:"Intensity/brightness of the light"},color:{value:n.color,default:n.color,type:"color",onChange:function(t){e().color.set(t)},description:"Color of the light"}},"ambient"!==n.type&&(i.value.x={value:n.position.x,default:n.position.x,min:-2,max:2,onChange:function(t){e().position.x=t},description:"X-coordinate of the light"},i.value.y={value:n.position.y,default:n.position.y,min:1,max:3,onChange:function(t){e().position.y=t},description:"Y-coordinate of the light"},i.value.z={value:n.position.z,default:n.position.z,min:-2,max:2,onChange:function(t){e().position.z=t},description:"Z-coordinate of the light"}),"point"===n.type&&(i.value.distance={value:n.distance,default:n.distance,min:.05,max:3,onChange:function(t){e().distance=t},description:"How far away the light reaches"},i.value.decay={value:n.decay,default:n.decay,min:1,max:4,onChange:function(t){e().decay=t},description:"How much the light decreases in intensity across distance"}),i},P=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this,(function(){return{metalness:{value:.1,default:.1,min:0,max:1,onChange:function(t){e.material.metalness=t},description:"How metallic the surface looks"},roughness:{value:.3,default:.3,min:0,max:1,onChange:function(t){e.material.roughness=t},description:"How rough the surface is. A low value means clearer reflections"},bumpScale:{value:.03,default:.03,min:0,max:.2,step:.001,onChange:function(t){e.material.normalScale=new E.qb(t,t)},description:"The amount of small details"},displacement:{value:{amount:{value:.2,default:.2,min:0,max:1,onChange:function(t){e.material.displacementScale=t,e.material.displacementBias=-t/2},description:"The height of the surface peaks"},smoothness:{value:.1,default:.1,min:0,max:1,onChange:function(t){e.blurPass.scale=t},description:"The smoothness of the surface peaks"}}},fog:{value:{color:{value:"#000000",default:"#000000",type:"color",onChange:function(t){e.scene.fog.color.set(t),e.scene.background.set(t)},description:"The color of the background and fog"},near:{value:.43,default:.43,min:.001,max:1,onChange:function(t){e.scene.fog.near=t},description:"At what distance the fog starts to take affect"},far:{value:1.8,default:1.8,min:.1,max:4,onChange:function(t){e.scene.fog.far=t},description:"At what distance the fog takes full effect"}}},lighting:{value:{ambientLight:M((function(){return e.ambientLight}),"Static, ambient background lighting",{type:"ambient",color:"#ffffff",intensity:.3}),directionalLight:M((function(){return e.directionalLight}),"Directional light, similar to the sun or another far away light source",{type:"directional",color:"#ffffff",intensity:.75,position:new E.rb(0,2,-2)}),pointLight:M((function(){return e.pointLight}),"Positional light that affects the scene based on the proximity to the light source",{type:"point",color:"#ffffff",intensity:1.9,decay:2,distance:5,position:new E.rb(0,1,-.25)})},description:"Settings for the lights"}}}))).near=.01,e.far=50,e.initialized=!1,e}return Object(c.a)(n,[{key:"initialize",value:function(e,t){this.canvas=t,this.renderer=new E.vb({canvas:t,antialias:!1,powerPreference:"high-performance"}),this.renderer.physicallyCorrectLights=!0,this.camera=new E.Y(75,t.width/t.height,this.near,this.far),this.camera.position.set(0,.5,.75),this.controls=new N.a(this.camera,t),this.controls.rotationSpeed=3,this.controls.dynamicDampingFactor=.15,this.scene=new E.ib,this.scene.background=new E.l(this.getValue("fog.color")),this.scene.fog=new E.x(this.getValue("fog.color"),this.getValue("fog.near"),this.getValue("fog.far"));var n=new E.i(e);n.needsUpdate=!0,n.magFilter=E.F,n.minFilter=E.F,this.texture=n,this.normalMaterial=new E.jb(D),this.normalMaterial.uniforms.width.value=t.clientWidth,this.normalMaterial.uniforms.height.value=t.clientHeight;var i=new L.e(this.normalMaterial,"tDiffuse");this.normalMapProducer=new A(this.renderer,n,t.clientWidth,t.clientHeight,[i]);var r=new L.a({kernelSize:L.c.MEDIUM});this.blurPass=r,this.heightMapProducer=new A(this.renderer,n,t.clientWidth,t.clientHeight,[r]);var a=this.normalMapProducer.getProcessedTexture(),o=this.heightMapProducer.getProcessedTexture(),s=new E.Z(1,1,500,500),l=new E.S({color:"#ffffff",map:n,metalness:this.getValue("metalness"),roughness:this.getValue("roughness"),normalMap:a,normalScale:new E.qb(this.getValue("bumpScale"),this.getValue("bumpScale")),displacementMap:o,displacementScale:this.getValue("displacement.amount"),displacementBias:-this.getValue("displacement.amount")/2}),c=new E.O(s,l);return c.rotation.x=-Math.PI/2,this.material=l,this.ambientLight=new E.c(this.getValue("lighting.ambientLight.color"),this.getValue("lighting.ambientLight.intensity")),this.directionalLight=new E.q(this.getValue("lighting.directionalLight.color"),this.getValue("lighting.directionalLight.intensity")),this.directionalLight.position.set(this.getValue("lighting.directionalLight.x"),this.getValue("lighting.directionalLight.y"),this.getValue("lighting.directionalLight.z")),this.pointLight=new E.ab(this.getValue("lighting.pointLight.color"),this.getValue("lighting.pointLight.intensity"),this.getValue("lighting.pointLight.distance"),this.getValue("lighting.pointLight.decay")),this.pointLight.position.set(this.getValue("lighting.pointLight.x"),this.getValue("lighting.pointLight.y"),this.getValue("lighting.pointLight.z")),this.scene.add(c,this.ambientLight,this.directionalLight,this.pointLight),this.composer=new z.a(this.renderer),this.composer.addPass(new G.a(this.scene,this.camera)),this.composer.setPixelRatio(window.devicePixelRatio),this.initialized=!0,this.handleResize(),!0}},{key:"isInitialized",value:function(){return this.initialized}},{key:"update",value:function(e){this.controls.update(),this.texture.needsUpdate=!0}},{key:"render",value:function(e){if(this.normalMapProducer.render(e),this.heightMapProducer.render(e),this.composer.render(e),this.captureNext){this.captureNext=!1;var t=this.canvas.toDataURL("image/png");this.dataCallback(t)}}},{key:"captureFrame",value:function(e){this.captureNext=!0,this.dataCallback=e}},{key:"handleResize",value:function(){if(this.initialized){var e=this.canvas.clientWidth,t=this.canvas.clientHeight,n=this.renderer.getSize(new E.qb),i=new E.qb(e,t);n.equals(i)||(this.renderer.setSize(i.x,i.y,!1),this.composer.setSize(i.x,i.y),this.normalMaterial.uniforms.width.value=i.x,this.normalMaterial.uniforms.height.value=i.y,this.camera.aspect=i.x/i.y,this.camera.updateProjectionMatrix(),this.normalMapProducer.setSize(i.x,i.y),this.heightMapProducer.setSize(i.x,i.y))}}}]),n}(_),F=n(43),U=function(){function e(){Object(l.a)(this,e),this.previousMillis=Date.now(),this.animationFrameId=-1,this.callbacks=[],this.running=!1,this.lastSecond=this.previousMillis,this.framesSinceLastSecond=0,this.currentFrameRate=0,this.frameRateAlpha=.3,this.averageFrameRate=0,this.recording=!1}return Object(c.a)(e,[{key:"setCallback",value:function(e){this.callbacks=[e]}},{key:"addCallback",value:function(e){this.removeCallback(e),this.callbacks.push(e)}},{key:"removeCallback",value:function(e){this.callbacks=this.callbacks.filter((function(t){return""+t!=""+e}))}},{key:"removeAllCallbacks",value:function(){this.callbacks=[]}},{key:"isRunning",value:function(){return this.running}},{key:"start",value:function(){var e=this;if(!this.isRunning()){this.running=!0;!function t(){var n=Date.now(),i=(n-e.previousMillis)/1e3;e.callbacks.forEach((function(e){return e(i)})),e.previousMillis=n,e.animationFrameId=requestAnimationFrame(t),e.framesSinceLastSecond++,n-e.lastSecond>1e3&&(e.currentFrameRate=e.framesSinceLastSecond,e.framesSinceLastSecond=0,e.lastSecond=n,e.averageFrameRate=e.frameRateAlpha*e.currentFrameRate+(1-e.frameRateAlpha)*e.averageFrameRate)}()}}},{key:"stop",value:function(){this.running=!1,this.recording&&this.stopRecording(),cancelAnimationFrame(this.animationFrameId)}},{key:"getFrameRate",value:function(){return this.currentFrameRate}},{key:"getAverageFrameRate",value:function(){return this.averageFrameRate}},{key:"startRecording",value:function(e,t){var n=this;this.stop(),this.recording=!0;var i=1/e;!function e(){n.callbacks.forEach((function(e){return e(i)})),Object(F.addFrame)(t).then((function(){n.animationFrameId=requestAnimationFrame(e)}))}()}},{key:"stopRecording",value:function(){this.recording&&(this.recording=!1,Object(F.downloadBundle)(),this.stop(),this.previousMillis=Date.now(),this.start())}}]),e}(),I=n(13),B=function(){function e(){Object(l.a)(this,e),this.canvas=null,this.gl=null,this.initialized=!1,this.uniformLocations=new WeakMap,this.EXT_color_buffer_float=null,this.KHR_parallel_shader_compile=null}return Object(c.a)(e,[{key:"initialize",value:function(e){if(console.log("Initializing webgl context"),!e)return console.log("The canvas is not initialized"),!1;var t=e.getContext("webgl2");return t?this.hasWebGL2=!0:(console.log("Webgl2 not supported, falling back on webgl1"),t=e.getContext("webgl"),this.hasWebGL2=!1),t||(console.log("Webgl not supported, falling back on experimental-webgl"),t=e.getContext("experimental-webgl")),t?(this.EXT_color_buffer_float=t.getExtension("EXT_color_buffer_float"),this.EXT_color_buffer_float?this.hasFloatColorBuffer=!0:(console.log("Floating point color buffers not supported. Quality will be reduced"),this.hasFloatColorBuffer=!1),this.maxVertexAttrib=0,this.canvas=e,this.gl=t,this.initialized=!0,!0):(alert("Your browser does not support WebGL"),!1)}},{key:"webGL2Supported",value:function(){return this.hasWebGL2}},{key:"floatColorBufferSupported",value:function(){return this.hasFloatColorBuffer}},{key:"isInitialized",value:function(){return this.initialized}},{key:"setQuadAttributeLayout",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.setAttribLayout(e,t,2,this.gl.FLOAT,4*Float32Array.BYTES_PER_ELEMENT,0),n&&this.setAttribLayout(e,n,2,this.gl.FLOAT,4*Float32Array.BYTES_PER_ELEMENT,2*Float32Array.BYTES_PER_ELEMENT)}},{key:"createFullScreenQuad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=[-1,1,0,1,-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1,1,-1,1,0];this.quadBuffer=this.createBuffer(this.gl.ARRAY_BUFFER,i,this.gl.STATIC_DRAW),e&&t&&this.setQuadAttributeLayout(e,t,n)}},{key:"createBuffer",value:function(e,t,n){var i=this.gl.createBuffer();return this.bindBuffer(e,i),this.gl.bufferData(e,new Float32Array(t),n),i}},{key:"createFramebuffer",value:function(e){var t=this.gl.createFramebuffer();return this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,t),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,e,0),this.webGL2Supported()&&this.gl.drawBuffers([this.gl.COLOR_ATTACHMENT0]),t}},{key:"createTexture",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.gl.RGBA,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.gl.RGBA,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.gl.UNSIGNED_BYTE,a=this.gl.createTexture();this.gl.bindTexture(this.gl.TEXTURE_2D,a);var o=0,s=0,l=null;return this.gl.texImage2D(this.gl.TEXTURE_2D,o,i,e,t,s,n,r,l),r!==this.gl.FLOAT?this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR):(this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST)),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),a}},{key:"createImageTexture",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.gl.CLAMP_TO_EDGE,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.gl.LINEAR,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=this.createTexture(1,1,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE),s=new Image;return s.onload=function(){t.gl.bindTexture(t.gl.TEXTURE_2D,o),t.gl.texImage2D(t.gl.TEXTURE_2D,0,t.gl.RGBA,t.gl.RGBA,t.gl.UNSIGNED_BYTE,s),t.gl.texParameteri(t.gl.TEXTURE_2D,t.gl.TEXTURE_WRAP_S,n),t.gl.texParameteri(t.gl.TEXTURE_2D,t.gl.TEXTURE_WRAP_T,n),t.gl.texParameteri(t.gl.TEXTURE_2D,t.gl.TEXTURE_MIN_FILTER,i),t.gl.texParameteri(t.gl.TEXTURE_2D,t.gl.TEXTURE_MAG_FILTER,i),r&&r(s.width,s.height)},s.onerror=function(){a&&a()},s.src=e,o}},{key:"compileAndLinkShaders",value:function(e){var t,n=[],i=Object(I.a)(e);try{for(i.s();!(t=i.n()).done;){var r=Object(s.a)(t.value,2),a=r[0],o=r[1],l=this._createShader(a,this.gl.VERTEX_SHADER),c=this._createShader(o,this.gl.FRAGMENT_SHADER),u=this._createShaderProgram(l,c);n.push([l,c,u])}}catch(k){i.e(k)}finally{i.f()}for(var h=0,f=n;h<f.length;h++){var d=Object(s.a)(f[h],2),m=d[0],p=d[1];this._compileShader(m),this._compileShader(p)}for(var g=0,v=n;g<v.length;g++){var b=Object(s.a)(v[g],3)[2];this.gl.linkProgram(b)}for(var x=0,y=n;x<y.length;x++){var j=Object(s.a)(y[x],3),C=j[0],w=j[1],O=j[2];if(!this.gl.getProgramParameter(O,this.gl.LINK_STATUS))return console.error("Link failed: "+this.gl.getProgramInfoLog(O)),console.error("vs info-log: "+this.gl.getShaderInfoLog(C)),console.error("fs info-log: "+this.gl.getShaderInfoLog(w)),null}return n.map((function(e){return Object(s.a)(e,3)[2]}))}},{key:"compileAndLinkShader",value:function(e,t){return this.compileAndLinkShaders([[e,t]])[0]}},{key:"_createShader",value:function(e,t){var n=this.gl.createShader(t);return this.gl.shaderSource(n,e),n}},{key:"_compileShader",value:function(e){e.compiled||(this.gl.compileShader(e),e.compiled=!0)}},{key:"_createShaderProgram",value:function(e,t){var n=this.gl.createProgram();return this.gl.attachShader(n,e),this.gl.attachShader(n,t),n}},{key:"bindFramebuffer",value:function(e){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e)}},{key:"renderFullScreenQuad",value:function(e){this.setShaderProgram(e),this.bindBuffer(this.gl.ARRAY_BUFFER,this.quadBuffer),this.clear(0,0,0,1),this.draw(6)}},{key:"clear",value:function(e,t,n,i){this.gl.clearColor(e,t,n,i),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},{key:"draw",value:function(e){this.gl.drawArrays(this.gl.TRIANGLES,0,e)}},{key:"setViewport",value:function(e,t){this.gl.viewport(0,0,e,t)}},{key:"setAttribLayout",value:function(e,t,n,i,r,a){var o=this.gl.getAttribLocation(e,t);if(o>this.maxVertexAttrib&&(this.maxVertexAttrib=o),-1===o)return-1;this.gl.vertexAttribPointer(o,n,i,this.gl.FALSE,r,a),this.gl.enableVertexAttribArray(o)}},{key:"setShaderProgram",value:function(e){this.currentProgram!==e&&(this.currentProgram=e,this.gl.useProgram(e))}},{key:"setUniform",value:function(e,t,n,i){this.setShaderProgram(e);var r={program:e,name:t},a=this.uniformLocations.get(r);"undefined"===typeof a&&(a=this.gl.getUniformLocation(e,t),this.uniformLocations.set(r,a)),this.gl["uniform"+n](a,i)}},{key:"setTexture",value:function(e,t){this.gl.activeTexture(this.gl["TEXTURE"+t]),this.gl.bindTexture(this.gl.TEXTURE_2D,e)}},{key:"deleteTexture",value:function(e){this.gl.deleteTexture(e)}},{key:"deleteFramebuffer",value:function(e){this.gl.deleteFramebuffer(e)}},{key:"flush",value:function(){this.gl.flush()}},{key:"bindBuffer",value:function(e,t){this.gl.bindBuffer(e,t)}},{key:"getGL",value:function(){return this.gl}}]),e}(),V="precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 vertPosition;\nattribute vec2 inTexCoord;\n\nattribute vec3 vertColor;\n\nvarying vec3 fragColor;\nvarying vec2 texCoord;\n\nvoid main() \n{\n    fragColor = vertColor;\n    texCoord = inTexCoord;\n    gl_Position = vec4(vertPosition, 0.0, 1.0);\n}",X=n.p+"static/media/LDR_RGBA_7.0ec5ab28.png",H=new(function(){function e(){Object(l.a)(this,e),this.initialized=!1,this.controllers=null,this.paused=!1,this.canvas=null,this.anchored=!1,this.anchor=null,this.previousPosition=null,this.GLC=new B,this.AM=new U,this.RC=new S,this.TXC=new T,this.CC=new R,this.TDC=new P,this.render3D=!1,this.controllers={RC:this.RC,TXC:this.TXC,CC:this.CC,TDC:this.TDC},this.updateCallbacks=new Map,this.onUpdate=null}return Object(c.a)(e,[{key:"initialize",value:function(e,t,n){if(!this.initialized){if(!this.GLC.initialize(e))throw new Error("GLC failed to initialize");var i=this.GLC.compileAndLinkShaders([[V,"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#define GLSLIFY 1\n#endif\n\nstruct Modifications {\n    float ridgeThreshold;\n\n    float pow;\n\n    float xStretch;\n    float yStretch;\n    \n    float mod;\n};\n\nstruct NoiseSettings {\n    int type;\n    int dimensions;\n    float frequency;\n    float amplitude;\n    vec3 offset;\n\n    int octaves;\n    float lacunarity;\n    float persistence;\n    \n    Modifications modifications;\n};\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\nint PERLIN = 0;\nint SIMPLEX = 1;\n\nbool isnan( float val )\n{\n  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;\n}\n\nbool isinf(float val) {\n    return (val != 0.0 && val * 2.0 == val) ? true : false;\n}\n\nfloat getNoise(vec3 position, float frequency, float amplitude, vec3 offset, Modifications modifications) {\n    vec3 sample = position * vec3(modifications.xStretch, modifications.yStretch, 1.0) * frequency + offset;\n    float result = 0.0;\n\n    result = snoise(sample);\n    result = 0.5 + result / 2.0;\n\n    // Apply modiifcations\n    if(modifications.ridgeThreshold < 1.0) {\n        float threshold = max(0.5, modifications.ridgeThreshold);\n        if(result > threshold) {\n            result = threshold - (result - threshold);\n        }\n        //TODO fix magic number etc\n        result /= threshold;\n        //pow(threshold, 0.70);\n    }\n    if(modifications.pow != 1.0) {\n        result = pow(result, modifications.pow);\n    }\n\n    if(modifications.mod != 1.0) {\n        result = fract(result * modifications.mod);\n    }\n\n    // Verify valid result\n    if(isnan(result)) {\n        result = 0.0;\n    }\n    if(isinf(result)) {\n        result = 1.0;\n    }\n\n    return amplitude * result;\n}\n\nfloat noiseSupplier(NoiseSettings settings, vec3 position) {\n    int octaves = settings.octaves;\n    vec3 offset = settings.offset;\n    Modifications modifications = settings.modifications;\n\n    float result = 0.0;\n    float max = 0.0;\n    if(octaves == 1) {\n        result = getNoise(position, settings.frequency, 1.0, offset, modifications);\n        max = 1.0;\n    } else if(octaves == 3) {\n        for(int i = 0; i < 3; i++) {\n            float f = settings.frequency * pow(settings.lacunarity,  float(i));\n            float a = 1.0                * pow(settings.persistence, float(i));\n            result += getNoise(position, f, a, offset, modifications);\n            max += a;\n        }\n    } else if(octaves == 5) {\n        for(int i = 0; i < 5; i++) {\n            float f = settings.frequency * pow(settings.lacunarity,  float(i));\n            float a = 1.0                * pow(settings.persistence, float(i));\n            result += getNoise(position, f, a, offset, modifications);\n            max += a;\n        }\n    }\n\n    return settings.amplitude * result / max;\n}\n\n#define PI 3.1415926538\n\nvec2 polarWarp(vec2 point, NoiseSettings angleControl, NoiseSettings amountControl, float max) {\n    vec3 p = vec3(point.xy, 0);\n\n    float amount = noiseSupplier(amountControl, p) * max;\n    float angle = noiseSupplier(angleControl, p) * PI * 2.0;\n    vec2 offset = vec2(cos(angle), sin(angle)) * amount;\n\n    return point + offset;\n}\n\n#define PI 3.1415926538\n\nvarying vec3 fragColor;\n\nuniform NoiseSettings source;\nuniform NoiseSettings angleControl;\nuniform NoiseSettings amountControl;\n\nuniform int octaves;\n\nuniform float scale;\nuniform vec2 viewport;\n\nuniform vec2 position;\n\nuniform float warpAmount;\nuniform int iterations;\n\n#define RECURSIVE_WARP(p, angle, amount, iterations) for(int i = 0; i < (iterations); i++) { p = polarWarp(p, (angle), (amount), warpAmount); }\n\nvec2 recursiveWarp(vec2 p, NoiseSettings angleControl, NoiseSettings amountControl) {\n    if(iterations == 0) {\n    } else if(iterations == 1) {\n        RECURSIVE_WARP(p, angleControl, amountControl, 1);\n    } else if(iterations == 2) {\n        RECURSIVE_WARP(p, angleControl, amountControl, 2);\n    } else if(iterations == 3) {\n        RECURSIVE_WARP(p, angleControl, amountControl, 3);\n    } else {\n        RECURSIVE_WARP(p, angleControl, amountControl, 4);\n    }\n    return p;\n}\n\nvec3 getColor(vec2 coord, NoiseSettings source, NoiseSettings angle, NoiseSettings amount) {\n    vec2 p = recursiveWarp(coord, angle, amount);\n\n    float e = noiseSupplier(angle, vec3(p.xy, 0));\n\n    float a = noiseSupplier(amount, vec3(p.xy, 0));\n\n    float v = noiseSupplier(source, vec3(p.xy, 0));\n\n    /*vec2 pack = vec2(1.0 * v, 255.0 * v);\n    pack = fract(pack);\n    pack -= pack.yy * vec2(1.0 / 255.0, 0.0);*/\n\n    //return vec3(e, a, pack.xy);\n    return vec3(v, a, e);\n}\n\nvoid main()\n{\n    float proportions = viewport.y / viewport.x;\n    vec2 center = vec2(0.5, 0.5 * proportions);\n    vec2 pos = vec2(\n        gl_FragCoord.x / viewport.x, \n       (gl_FragCoord.y / viewport.y) * proportions\n    );\n\n    pos -= center;\n    pos *= scale;\n    pos += center;\n    pos += position;\n\n    vec3 color = getColor(pos, source, angleControl, amountControl);\n    gl_FragColor = vec4(color, 1.0);\n}\n"],[V,"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#define GLSLIFY 1\n#endif\n\n/////////////\n// IMPORTS //\n/////////////\nvec3 hsv2rgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\n///////////////////\n// COLOR CONTROL //\n///////////////////\nint ADD = 0;\nint MULT = 1;\n\nstruct ComponentController {\n    bool mult;\n    float source;\n    float angle;\n    float amount;\n};\n\nstruct ColorBalance {\n    float hue;\n    float saturation;\n    float brightness;\n\n    float red;\n    float green;\n    float blue;\n};\n\nuniform float power;\nuniform ColorBalance general;\n\nuniform ComponentController hueController;\nuniform ComponentController saturationController;\nuniform ComponentController brightnessController;\n\n///////////////\n// DITHERING //\n///////////////\nuniform float ditheringAmount;\nuniform bool hasDitheringTexture;\nuniform highp sampler2D ditheringTexture;\nuniform vec2  ditheringTextureDimensions;\n\n//////////////////\n// MAIN TEXTURE //\n//////////////////\nvarying vec2 texCoord;\nuniform highp sampler2D texture;\n\n//////////\n// MISC //\n//////////\nuniform float time;\nuniform vec2 viewport;\nuniform bool multisampling;\n\n///////////////////\n// COLOR CONTROL //\n///////////////////\n\n// Returns a single color component\nfloat getComponent(vec4 data, ComponentController controller) {\n    float result;\n    if(controller.mult) {\n        result = pow(data.x, controller.source) *\n                 pow(data.y, controller.angle)  *\n                 pow(data.z, controller.amount);\n    } else {\n        float divider = max(1.0, controller.source + controller.angle + controller.amount);\n        result = (data.x * controller.source +\n                  data.y * controller.angle  +\n                  data.z * controller.amount) /\n                  divider;\n    }\n    return max(0.0, min(result, 1.0));\n}\n\nvec3 dither(vec3 value) {\n    if(hasDitheringTexture) {\n        vec2 ditheringCoord = gl_FragCoord.xy / ditheringTextureDimensions + vec2(fract(time * 13.41), fract(time * 3.451));\n        vec3 ditherValue = texture2D(ditheringTexture, ditheringCoord).rgb;\n\n        ditherValue = ditherValue * 2.0 - 1.0;\n        ditherValue = sign(ditherValue) * (1.0 - sqrt(1.0 - abs(ditherValue)));\n\n        value += ditheringAmount * ditherValue;\n    }\n    return value;\n}\n\n// Converts from linear color space to SRGB\nvec3 linearToSRGB(vec3 linearRGB){\n    float limit = 0.0031308;\n    if(linearRGB.r < limit && linearRGB.g < limit && linearRGB.b < limit) {\n        return 12.92 * linearRGB;\n    } else {\n        return 1.055 * \n            vec3(pow(linearRGB.r, 1.0 / 2.4) - 0.055,\n                 pow(linearRGB.g, 1.0 / 2.4) - 0.055,\n                 pow(linearRGB.b, 1.0 / 2.4) - 0.055);\n    }\n}\n\n// Converts from sRGB to linear color space\nvec3 sRGBToLinear(vec3 sRGB) {\n    float limit = 0.04045;\n    if(sRGB.r < limit && sRGB.g < limit && sRGB.b < limit) {\n        return sRGB / 12.92;\n    } else {\n        return vec3(\n            pow(sRGB.r * (1.0 / 1.055) + 0.055 / 1.055, 2.4),\n            pow(sRGB.g * (1.0 / 1.055) + 0.055 / 1.055, 2.4),\n            pow(sRGB.b * (1.0 / 1.055) + 0.055 / 1.055, 2.4)\n        );\n    }\n}\n\n// Returns the resulting color using the data from the previous render pass\nvec3 getColor(vec4 data) {\n    float h = getComponent(data, hueController);\n    if(h > 1.0) h = fract(h);\n    else if(h < 1.0) h = 1.0 - fract(h);\n\n    float s = getComponent(data, saturationController);\n    s = max(0.0, min(s, 1.0));\n\n    float b = getComponent(data, brightnessController);\n    b = max(0.0, min(b, 1.0));\n\n    // Hue modifications\n    h += general.hue;\n\n    // Bri modifications\n    b = pow(b, power);\n    b = b * general.brightness;\n\n    // Sat modifications\n    s *= general.saturation;\n\n    vec3 color = hsv2rgb(vec3(h, s, b));\n\n    // RGB modifications\n    color.r *= pow(general.red,   general.saturation);\n    color.g *= pow(general.green, general.saturation);\n    color.b *= pow(general.blue,  general.saturation);\n\n    // Dithering\n    if(ditheringAmount > 0.0) {\n        return sRGBToLinear(dither(linearToSRGB(color)));\n    } else {\n        return color;\n    }\n}\n\nvoid main()\n{\n    vec3 color;\n    vec4 data;\n\n    if(!multisampling) {\n        data = texture2D(texture, texCoord);\n    } else {\n        float xStep = 1.0 / viewport.x;\n        float yStep = 1.0 / viewport.y;\n\n        float xOffset = 3.0 * xStep / 8.0;\n        float yOffset = 3.0 * yStep / 8.0;\n\n        data =  texture2D(texture, texCoord + vec2(-xOffset, -yOffset / 2.0));\n        data += texture2D(texture, texCoord + vec2(xOffset / 2.0, -yOffset));\n        data += texture2D(texture, texCoord + vec2(-xOffset / 2.0, yOffset));\n        data += texture2D(texture, texCoord + vec2(xOffset, yOffset / 2.0));\n        data /= 4.0;\n    }\n\n    color = getColor(data);\n\n    gl_FragColor = vec4(color, 1.0);\n}\n"]]);if(!i)throw new Error("Shader program linking failed");var r=Object(s.a)(i,2),a=r[0],o=r[1];if(this.GLC.createFullScreenQuad(),this.GLC.setQuadAttributeLayout(a,"vertPosition"),this.GLC.setQuadAttributeLayout(o,"vertPosition","inTexCoord"),!this.RC.initialize(e,this.GLC))throw new Error("Render controller failed to initialize");if(!this.TXC.initialize(e,a,this.GLC))throw new Error("Texture controller failed to initialize");if(this.TXC.setPaused(this.paused),!this.CC.initialize(e,o,this.GLC,X))throw new Error("Color controller failed to initialize");return this.TDC.initialize(e,t)||console.error("3D controller failed to initialize. 3D disabled"),this.onUpdate=n,this.canvas=e,this.initialized=!0,!0}}},{key:"isInitialized",value:function(){return this.initialized}},{key:"_render",value:function(e){var t=this.RC.getFrameBuffer(),n=this.RC.getRenderTexture(),i=this.RC.getRenderTextureDimensions(),r=this.RC.getDimensions(),a=this.RC.getValue("ditheringAmount");this.TXC.render(t,i,e),this.CC.render(n,r,this.RC.getValue("multisampling"),a,this.paused?0:e),this.render3D&&this.TDC.render(e)}},{key:"start",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.AM.isRunning()||(this.AM.setCallback((function(n){e._render(n),e.render3D&&e.TDC.update(n),t&&t()})),this.AM.start())}},{key:"addUpdateCallback",value:function(e){this.AM.addCallback(e)}},{key:"removeUpdateCallback",value:function(e){this.AM.removeCallback(e)}},{key:"removeAllUpdateCallbacks",value:function(){this.AM.removeAllCallbacks()}},{key:"stop",value:function(){this.AM.stop()}},{key:"animationManager",value:function(){return this.AM}},{key:"startRecording",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60;this.AM.startRecording(e,this.canvas)}},{key:"stopRecording",value:function(){this.AM.stopRecording()}},{key:"handleResize",value:function(){this.RC.handleResize(),this.TDC.handleResize(),this.resizeCallback&&this.resizeCallback(this.getDimensions())}},{key:"addResizeCallback",value:function(e){this.RC.addResizeCallback(e)}},{key:"captureFrame",value:function(e){this.render3D?this.TDC.captureFrame(e):this.CC.captureFrame(e)}},{key:"setRender3D",value:function(e){this.TDC.isInitialized()&&(this.render3D=e)}},{key:"changeAnimationSpeed",value:function(e){var t=this.TXC.getValue("animationSpeed.general");this.updateValue("TXC","animationSpeed.general",Math.max(t*(1+e)))}},{key:"changeScale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.TXC.getValue("scale"),i=e*n;if(n+=i,this.updateValue("TXC","scale",n)&&t){var r=this._screenSpaceToViewSpace([(t[0]-window.innerWidth/2)*i,(t[1]-window.innerHeight/2)*i]),a=this.TXC.getPosition();this.TXC.setPosition([a[0]-r[0],a[1]+r[1]])}}},{key:"move",value:function(e){this.anchored=!1;var t=this.TXC.getPosition(),n=this.TXC.getValue("scale");e=this._screenSpaceToViewSpace(e),this.TXC.setPosition([t[0]+e[0]*n,t[1]+e[1]*n])}},{key:"setAnchor",value:function(e){if(this.anchored)return!1;this.anchor=e;var t=this.TXC.getPosition();return this.previousPosition=[t[0],t[1]],this.anchored=!0,!0}},{key:"liftAnchor",value:function(){return!!this.anchored&&(this.anchored=!1,!0)}},{key:"anchorMove",value:function(e){if(!this.anchored)return!1;var t=this.TXC.getValue("scale"),n=this._screenSpaceToViewSpace([(this.anchor[0]-e[0])*t,(this.anchor[1]-e[1])*t]);this.TXC.setPosition([this.previousPosition[0]+n[0],this.previousPosition[1]-n[1]])}},{key:"randomize",value:function(){this.TXC.randomize(),this.CC.randomize(),this.onUpdate&&this.onUpdate()}},{key:"exportSettings",value:function(){var e={};for(var t in this.controllers){var n=this._getController(t);e[t]=n.getAttributes()}return e}},{key:"importSettings",value:function(e){for(var t in this.controllers){var n=this._getController(t),i=e[t];if(i){var r=n.getAttributes(),a=k(O(r),i);n.setAttributes(a)}}this.onUpdate&&this.onUpdate()}},{key:"getFrameRate",value:function(){return this.AM.getFrameRate()}},{key:"getAverageFrameRate",value:function(){return this.AM.getAverageFrameRate()}},{key:"getDimensions",value:function(){return this.RC.getDimensions()}},{key:"_getController",value:function(e){var t=this.controllers[e];if(!t)throw new Error("No such controller");return t}},{key:"getValue",value:function(e,t){if(this.initialized)return this._getController(e).getValue(t)}},{key:"getDefault",value:function(e,t){if(this.initialized)return this._getController(e).getDefault(t)}},{key:"getAttributes",value:function(e){if(this.initialized)return this._getController(e).getAttributes()}},{key:"isAnchored",value:function(){return this.anchored}},{key:"isPaused",value:function(){return this.paused}},{key:"updateValue",value:function(e,t,n){if(this.initialized){this.onUpdate&&this.onUpdate();var i=this._getController(e).updateValue(t,n),r=e+":"+t,a=this.updateCallbacks.get(r);return a&&a(e,t,n),i}}},{key:"setPaused",value:function(e){this.paused=e,this.TXC.setPaused(this.paused)}},{key:"setUpdateCallback",value:function(e,t,n){var i=e+":"+t;this.updateCallbacks.set(i,n)}},{key:"_screenSpaceToViewSpace",value:function(e){var t=window.innerWidth,n=window.innerHeight,i=n/t;return[e[0]/t,e[1]*i/n]}}]),e}()),q=function(e){return e.replace(/([A-Z])/g,(function(e){return" ".concat(e)})).replace(/^./,(function(e){return e.toUpperCase()})).trim()},W=function(e,t){var n=document.createElement("a");n.href=e,n.download=t,n.click()},Y=function(e){return"object"===typeof e},Q=function(e,t){return Object.entries(e).map((function(e,n){var i=Object(s.a)(e,2),r=i[0],a=i[1];return t(r,a,n)}))},K=function(e,t){return+e.toFixed(t||3)},J=(n(84),n(85),n(6)),Z=function(e){var t=e.direction;return Object(J.jsx)("div",{className:"arrow-container",children:Object(J.jsx)("div",{className:"arrow arrow--"+t})})},$=n.p+"static/media/github.04be58c1.svg",ee=n.p+"static/media/instagram.6ed2cb52.svg",te=n.p+"static/media/email.56058da1.svg",ne=n.p+"static/media/blog.9376783d.svg",ie=n.p+"static/media/repository.0dc86d09.png",re=(n(87),[{title:"A Recursive Domain Warping Controller",content:Object(J.jsxs)("div",{children:[Object(J.jsx)("p",{children:"Any image can be seen as a function of space. The input is a pixel location, an XY-coordinate, and the output is a pixel color. The width and height of the image are the domain. By warping the domain, we alter the space itself. Sampling a particular XY-coordinate will now (likely) result in a different output color than before. This is called domain warping."}),Object(J.jsx)("p",{children:"This technique is commonly used for texture generation, visual effects, or generative art. This application makes the technique not only accessible, but fast (using GLSL shaders) and easy to try out different configurations with."}),Object(J.jsxs)("p",{children:["To properly understand everything at work here, I suggest reading Inigo Quilez ",Object(J.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://www.iquilezles.org/www/articles/warp/warp.htm",children:"blog post"})," on the topic, or my own ",Object(J.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://palmdrop.site/nodes/domain-warping",children:"blog post"}),", where I discuss the specific variant of this technique used on this page. I also suggest reading about ",Object(J.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://en.wikipedia.org/wiki/Simplex_noise",children:"Simplex Noise"}),", which is used as an underlying function of space for both the source function and the functions that alter its domain."]}),Object(J.jsx)("p",{children:'There\'s a lot of settings available to you. They might be overwhelming or incomprehensible. The best way to learn what they do is to study the links from the previous paragraph, or just play around with them. If you want more information about what the obscure sliders actually do, press the "Show Tooltips" button in the upper right corner. Some information about each slider or button will be displayed when you hover the mouse over it.'}),Object(J.jsx)("p",{children:"In the top bar, there are buttons for saving a frame, for exporting or importing the current settings, among other things. Feel free to post your creations anywhere you like. But do provide a link to this site if you do. Please note that this application works best on modern browsers with support for WebGL2."}),Object(J.jsx)("p",{children:"There also exist a 3D mode, where the texture is converted to a 3D height map. See more information below."})]})},{title:"Texture",content:Object(J.jsxs)("div",{children:[Object(J.jsxs)("p",{children:["The ",Object(J.jsx)("i",{children:"texture controller"})," changes the characteristics of the underlying noise functions, as well as the warp effect itself. The ",Object(J.jsx)("i",{children:"warp amount"})," controls the strength of the effect. The ",Object(J.jsx)("i",{children:"iterations"})," is the number of times the warp is applied. The ",Object(J.jsx)("i",{children:"source"}),"is the noise function whos domain is sampled. The ",Object(J.jsx)("i",{children:"angle controller"})," controls the angle of the warp effect, across space, and the",Object(J.jsx)("i",{children:"amount controller"})," controls the strength of the warp effect. Each layer has sliders for controlling fractal noise settings (layers of noise)."]}),Object(J.jsxs)("p",{children:["I suggest reading ",Object(J.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://palmdrop.site/nodes/modified-noise",children:"this post"}),". It also covers some of the ",Object(J.jsx)("i",{children:"modifications"})," available."]})]})},{title:"Color",content:Object(J.jsxs)("div",{children:[Object(J.jsxs)("p",{children:["The ",Object(J.jsx)("i",{children:"color controller"})," gives precise control over the colors. There are some (hopefully) self-explanatory ",Object(J.jsx)("i",{children:"general"})," sliders, but also more specific controllers for hue, saturation and brightness. Each of these sub-controllers allows you to choose which layers (source, angle, and amount) will influence that part of the color. For example, you might want the source layer to increase brightness, while the angle layer decreases it."]}),Object(J.jsxs)("p",{children:["As a side effect, this might make the ",Object(J.jsx)("i",{children:"source"})," layer have varying influence over the final color. Do not be surprised if altering the ",Object(J.jsx)("i",{children:"source"})," settings in the ",Object(J.jsx)("i",{children:"texture"})," category does not change the results much. This is likely due to your ",Object(J.jsx)("i",{children:"color"})," settings."]})]})},{title:"Render",content:Object(J.jsx)("div",{children:Object(J.jsxs)("p",{children:["The ",Object(J.jsx)("i",{children:"render controller"})," gives you the ability to change resolution, control dithering, and multisampling. There's also an option to record the animation. Unfortunately, there's not yet support for converting the recorded frames into a video. Instead, you'll receive a zipped archive of PNG images."]})})},{title:"3D",content:Object(J.jsx)("div",{children:Object(J.jsxs)("p",{children:["The ",Object(J.jsx)("i",{children:"3D controller"})," controls the 3D mode of the application. The 3D mode displays the domain warp texture as a 3D height map that is lit by a set of lights. The material of the height map can be modified using a set of sliders, as well as the height of the peaks, the lighting and the background fog."]})})}]),ae=[{title:"Development",entries:[{link:"https://github.com/palmdrop",location:"Github",icon:$,description:"where I store my projects and configuration files"},{link:"https://github.com/palmdrop/surfaces",location:"Repository",icon:ie,description:"where you can find the source code for this app"}]},{title:"Social Media",entries:[{link:"https://www.instagram.com/palmdrop/",location:"Instagram",icon:ee,description:"where I post generative art and experiments"},{link:"https://palmdrop.github.io/",location:"Blog",icon:ne,description:"where I (occassionally) document my techniques"}]},{title:"Contact",entries:[{link:"mailto:anton@exlex.se",location:"Email",icon:te,description:"with which you can reach me if you have questions"}]}],oe=function(e){var t=e.mainTitle,n=e.shortcuts,r=e.visibility,a=e.page,o=e.onCloseCallback,l=Object(i.useState)(0),c=Object(s.a)(l,2),u=c[0],h=c[1];Object(i.useEffect)((function(){a&&h(a)}),[a]);var f=function(e){h(Math.max(Math.min(u+e,2),0))},d=function(){return Object(J.jsxs)("div",{className:"help-page__content__descriptions",children:[Object(J.jsx)("h2",{className:"title",children:t}),re.map((function(e,t){return function(e,t){return Object(J.jsxs)("div",{className:"descriptions-entry",children:[Object(J.jsx)("h3",{className:"descriptions-entry__title",children:e.title}),Object(J.jsx)("div",{className:"description-entry__content",children:e.content})]},t)}(e,t)}))]})},m=function(){return Object(J.jsxs)("div",{className:"help-page__content__contact",children:[Object(J.jsx)("h2",{className:"title",children:"Contact and Links"}),ae.map((function(e,t){return function(e,t){var n=function(e,n){return Object(J.jsxs)("div",{className:"contact-category__entry",children:[Object(J.jsx)("div",{className:"contact-category__entry__location",children:Object(J.jsxs)("a",{className:"contact-category__entry__link",href:e.link,target:"_blank",rel:"noreferrer",children:[e.icon?Object(J.jsx)("img",{className:"icon",src:e.icon,alt:""}):null,Object(J.jsx)("div",{className:"contact-category__entry__link__text",children:e.location})]})}),Object(J.jsx)("div",{className:"contact-category__entry__description",children:e.description})]},t+"."+n)};return Object(J.jsxs)("div",{className:"contact-category",children:[Object(J.jsx)("h4",{className:"contact-category__title",children:e.title}),e.entries.map((function(e,t){return n(e,t)}))]},t)}(e,t)}))]})};return Object(J.jsxs)("div",{className:"help-page"+(r?" help-page--visible":""),children:[Object(J.jsx)("button",{className:"help-page__close-button",onClick:function(e){o(e)}}),Object(J.jsx)("div",{className:"help-page__content",children:function(){switch(u){case 0:return d();case 1:return function(){var e=function(e){var t=function(e){switch(e){case" ":return"Space";case"-":return"Minus";case"+":return"Plus";default:return q(e)}},n="";return n=Array.isArray(e.keys)?e.keys.reduce((function(e,n){return t(e)+" / "+t(n)})):t(e.keys),Object(J.jsxs)("div",{className:"shortcut-entry",children:[Object(J.jsx)("div",{className:"shortcut-entry__keys",children:n}),Object(J.jsx)("div",{className:"shortcut-entry__description",children:e.description})]})};return Object(J.jsxs)("div",{className:"help-page__content__shortcuts",children:[Object(J.jsx)("h2",{className:"title",children:"Keyboard shortcuts"}),Object(J.jsxs)("div",{className:"shortcut__columns",children:[Object(J.jsx)("div",{className:"shortcut_columns__key",children:"Key"}),Object(J.jsx)("div",{className:"shortcut_columns__description",children:"Functionality"})]}),n.map((function(t,n){return Object(J.jsx)("div",{children:e(t)},n)}))]})}();case 2:return m();default:return null}}()}),Object(J.jsxs)("nav",{className:"help-page__buttons",children:[Object(J.jsxs)("button",{className:"help-page__buttons__button help-page__buttons__previous"+(0===u?" help-page__buttons__disabled":""),onClick:function(){return f(-1)},children:[Object(J.jsx)(Z,{direction:"left"}),Object(J.jsx)(Z,{direction:"left"}),Object(J.jsx)(Z,{direction:"left"})]}),Object(J.jsxs)("div",{className:"help-page__side-number",children:[u+1,"/3"]}),Object(J.jsxs)("button",{className:"help-page__buttons__button help-page__buttons__next"+(2===u?" help-page__buttons__disabled":""),onClick:function(){return f(1)},children:[Object(J.jsx)(Z,{direction:"right"}),Object(J.jsx)(Z,{direction:"right"}),Object(J.jsx)(Z,{direction:"right"})]})]})]})},se=Object(i.createContext)(),le=Object(i.createContext)(),ce=Object(i.createContext)(),ue=Object(i.createContext)(),he=function(){return Object(i.useContext)(se)},fe=function(){return Object(i.useContext)(ue)},de=function(e){var t=e.children,n=Object(i.useState)(null),r=Object(s.a)(n,2),a=r[0],o=r[1],l=Object(i.useState)(null),c=Object(s.a)(l,2),u=c[0],h=c[1],f=Object(i.useRef)(null);return Object(J.jsx)(se.Provider,{value:[a,u],children:Object(J.jsx)(le.Provider,{value:[function(e,t){o(e),h(t)}],children:Object(J.jsx)(ce.Provider,{value:function(e){f.current=e},children:Object(J.jsx)(ue.Provider,{value:function(e,t){f.current&&f.current(e,t)},children:t})})})})},me=(n(88),function(e){var t=e.categories,n=he(),r=Object(s.a)(n,1)[0],a=Object(i.useContext)(le),o=Object(s.a)(a,1)[0],l=fe();return Object(J.jsx)("div",{className:"category-bar",children:Q(t,(function(e,n,i){return Object(J.jsx)("div",{className:"category-bar__category-container"+(e===r?" category-bar__category-container--active":""),onClick:function(i){return function(e,n,i){e&&e.currentTarget.blur(),r===n?o(null,null):o(n,t[n]),i.onClickCallback&&i.onClickCallback(r===n)}(i,e,n)},onMouseOver:function(){return l(e,n.description)},children:Object(J.jsx)("div",{className:"category-bar__category"+(e===r?" category-bar__category--active":""),children:n.name||q(e)})},e+"."+i)}))})}),pe=n(120),ge=(n(89),function(e){var t=e.label,n=e.valueGetter,r=e.defaultValue,a=e.onChange,o=e.min,l=e.max,c=e.step,u=e.marks,h=(e.precision,e.fullName),f=Object(i.useRef)(),d=Object(i.useState)(K(n())),m=Object(s.a)(d,2),p=m[0],g=m[1];Object(i.useEffect)((function(){g(K(n()))}),[n]);var v=function(e){e!==n()&&(g(K(e)),a(e))},b=function(e){e.preventDefault();var t=-Math.sign(e.deltaY)*c,i=n()+t;i=Math.min(Math.max(i,o),l),u&&(i=u.reduce((function(e,t){return Math.abs(t-i)<Math.abs(e-i)?t:e}))),v(i)},x=function(e){v(r)};return Object(i.useEffect)((function(){var e=f.current;return e.addEventListener("wheel",b),e.addEventListener("dblclick",x),function(){e.removeEventListener("wheel",b),e.removeEventListener("dblclick",x)}})),Object(J.jsxs)("div",{className:"input-slider",children:[Object(J.jsxs)("div",{className:"input-slider__header",children:[Object(J.jsx)("h3",{className:"input-slider__label",children:t}),Object(J.jsx)("div",{className:"input-slider__value",children:p})]}),Object(J.jsx)(pe.a,{className:"input-slider__slider",value:p,onChange:function(e,t){return v(t)},min:o,max:l,step:c,marks:u,ref:f},h+"__slider")]})}),ve=n(119),be=(n(94),function(e){var t=e.label,n=e.valueGetter,r=e.onChange,a=e.fullName,o=Object(i.useRef)(),l=Object(i.useState)(n()),c=Object(s.a)(l,2),u=c[0],h=c[1];Object(i.useEffect)((function(){h(n())}),[n]);return Object(J.jsxs)("div",{className:"input-switch"+(u?" input-switch--active":""),ref:o,children:[Object(J.jsx)("h3",{className:"input-switch__label",children:t}),Object(J.jsx)(ve.a,{className:"input-switch__switch"+(u?" input-switch__switch--active":""),name:a,checked:!!u,onChange:function(e){if(e.target){var t=e.target.checked;t!==n()&&(h(t),r(t),e.target.blur())}},size:"small",color:"primary"},a)]})}),xe=n(54),ye=(n(95),function(e){var t=e.label,n=e.valueGetter,r=e.onChange,a=e.fullName,o=Object(i.useState)(n()),l=Object(s.a)(o,2),c=l[0],u=l[1];Object(i.useEffect)((function(){u(n())}),[n]);return Object(J.jsxs)("div",{className:"input-color",children:[Object(J.jsx)("label",{className:"input-color__label",children:t}),Object(J.jsx)(xe.a,{className:"input-color__color-picker",color:c,onChange:function(e){e!==n()&&(u(e),r(e))}},a)]})}),je=(n(96),function(e){var t=e.categoryData,n=e.attribute,r=e.fullName,a=e.precision,o=Object(i.useState)(!1),l=Object(s.a)(o,2),c=l[0],u=l[1];Object(i.useEffect)((function(){H.setUpdateCallback(t.controller,r,(function(){u(!c)}))}),[c,t.controller,r]);var h=t.getter,f=t.setter,d=t.default;return Object(J.jsx)("div",{className:"input-container",children:function(){var e=r.split(t.separator);return e=e[e.length-1],"color"===n.type?function(e,t){return Object(J.jsx)(ye,{label:q(e),valueGetter:function(){return h(t)},onChange:function(e){return f(t,e)},fullName:t},t)}(e,r):0===n.min&&1===n.max&&(n.step&&1===n.step||"1i"===n.type)?function(e,t){return Object(J.jsx)(be,{label:q(e),valueGetter:function(){return h(t)},onChange:function(e){return f(t,e)},fullName:t},t)}(e,r):function(e,t,n){return Object(J.jsx)(ge,{label:q(t),valueGetter:function(){return h(n)},defaultValue:d(n),onChange:function(e){return f(n,e)},min:e.min,max:e.max,step:e.hasOwnProperty("step")?e.step:"1i"===e.type?1:(e.max-e.min)/100,marks:e.marks,precision:a,fullName:n},n)}(n,e,r)}()})}),Ce=(n(97),n(98),function(e){var t=e.categoryData,n=e.attribute,r=e.name,a=e.parentName,o=e.precision,l=Object(i.useState)(!1),c=Object(s.a)(l,2),u=c[0],h=c[1],f=fe(),d=function(e){return e+(u?" "+e+"--expanded":"")};return Object(J.jsxs)("div",{className:d("input-dropdown-container"),children:[Object(J.jsxs)("div",{className:d("input-dropdown-header"),onClick:function(e){e&&e.target.blur(),h(!u)},onMouseOver:function(){return f(t.controller+"."+r,n.description)},children:[Object(J.jsx)("h3",{className:d("input-dropdown-title"),children:q(r)}),Object(J.jsx)(Z,{direction:u?"up":"down"})]}),Object(J.jsx)("div",{className:d("input-dropdown-content"),children:function e(n,i,r,a){return Object(J.jsxs)("div",{className:"input-dropdown__section"+(a?"":"-sub"),children:[a?"":Object(J.jsx)("h4",{className:"input-dropdown__section__title",onMouseOver:function(){return f(t.controller+"."+r,n.description)},children:q(i)}),Q(n.value,(function(n,i){var a=(r?r+t.separator:"")+n;return Y(i.value)?e(i,n,a,!1):Object(J.jsx)("div",{className:"input-dropdown__section__entry",onMouseOver:function(){return f(t.controller+"."+a,i.description)},children:Object(J.jsx)(je,{categoryData:t,attribute:i,fullName:a,precision:o})},a)}))]},r)}(n,null,a,!0)})]})}),we=function(e){var t=e.name,n=e.data,i=he(),r=Object(s.a)(i,1)[0],a=fe();return Object(J.jsxs)("div",{className:"category-settings"+(t===r?" category-settings--active":""),children:[n.before,Object(J.jsx)("div",{className:"category-settings__main-container",children:Object(J.jsx)("div",{className:"category-settings__main-entries",children:Q(n.attributes,(function(e,t,i){return Y(t.value)?null:Object(J.jsx)("div",{className:"category-settings__main-entry",onMouseOver:function(){return a(n.controller+"."+e,t.description)},children:Object(J.jsx)(je,{categoryData:n,attribute:t,fullName:e,precision:3})},i)}))})}),Q(n.attributes,(function(e,t,i){if(Y(t.value))return Object(J.jsx)("div",{className:"category-settings__secondary-container",children:Object(J.jsx)(Ce,{categoryData:n,attribute:t,name:e,parentName:e,precision:3})},i)})),n.after]})},Oe=(n(99),function(e){var t=e.left,n=e.center,i=e.right;return Object(J.jsxs)("nav",{className:"topbar",children:[Object(J.jsx)("nav",{className:"left-container",children:t}),Object(J.jsx)("nav",{className:"center-container",children:n}),Object(J.jsx)("nav",{className:"right-container",children:i})]})}),ke=(n(100),function(){var e=Object(i.useContext)(ce),t=Object(i.useState)(null),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(i.useState)(null),l=Object(s.a)(o,2),c=l[0],u=l[1];if(Object(i.useEffect)((function(){e((function(e,t){a(e),u(t)}))})),!r)return null;return Object(J.jsxs)("div",{className:"tooltip-container",children:[Object(J.jsx)("h3",{className:"tooltip__title",children:function(e){var t=e.lastIndexOf(".");return q(-1===t?e:e.substr(t+1))}(r)}),Object(J.jsx)("div",{className:"tooltip__content",children:c})]})}),_e=(n(101),function(e){var t=e.categories,n=e.topbar,i=e.showTooltip;return Object(J.jsx)("div",{className:"control-panel",children:Object(J.jsxs)(de,{children:[Object(J.jsx)(Oe,{left:n.left,center:n.center,right:n.right}),Object(J.jsx)(me,{categories:t}),Q(t,(function(e,t,n){return Object(J.jsx)(we,{name:e,data:t},e+"."+n)})),i?Object(J.jsx)(ke,{}):null]})})}),Te=(n(102),function(e){var t=e.name,n=e.activeName,r=e.hideName,a=void 0!==r&&r,o=e.onClick,l=e.blurOnClick,c=void 0===l||l,u=e.state,h=e.radius,f=e.description,d=e.children,m=Object(i.useState)(!1),p=Object(s.a)(m,2),g=p[0],v=p[1],b=fe();Object(i.useEffect)((function(){null!==u&&v(u)}),[u]);var x=function(e){return e+(g?" "+e+"--active":"")};return Object(J.jsx)("div",{className:x("button-container"),onClick:function(e){if(e&&c&&e.target.blur(),n||"undefined"!==typeof u){var t=!g;v(t),o(e,t)}else o(e)},onMouseOver:function(){b&&b("button."+t,f)},children:Object(J.jsxs)("button",{className:x("button"),style:{borderRadius:h},children:[a?null:g?n:t,d]})})}),Re=(n(103),function(e){var t=e.name,n=e.setterCallback,r=e.initial,a=Object(i.useState)(r),o=Object(s.a)(a,2),l=o[0],c=o[1];return Object(i.useEffect)((function(){n(c)}),[n]),Object(J.jsxs)("div",{className:"data-entry",children:[Object(J.jsxs)("div",{className:"data-entry__name",children:[t,":"]}),Object(J.jsx)("div",{className:"data-entry__value",children:l})]})}),Se=(n(104),function(e){var t=e.entries;return Object(J.jsx)("div",{className:"data-panel",children:Q(t,(function(e,t,n){return Object(J.jsx)("div",{className:"data-panel__entry-container",children:Object(J.jsx)(Re,{name:q(e),initial:0,setterCallback:t.setterCallback})},n)}))})}),Ee=function(e){var t=Object(i.useRef)(),n=Object(i.useRef)(),r=Object(i.useRef)(),a=Object(i.useReducer)((function(e){return e+1}),0),o=Object(s.a)(a,2)[1],l=function(){var e=Object(i.useRef)({}),t=Object(i.useRef)({}),n=Object(i.useRef)({}),r=function(n){var i=n.key,r="keydown"===n.type;r&&!a(i)&&t.current[i]&&(n.preventDefault(),t.current[i](n)),e.current[i]=r},a=function(t){return!1|e.current[t]},o=function e(t,n,i){if(Array.isArray(t)){var r,a=Object(I.a)(t);try{for(a.s();!(r=a.n()).done;)e(r.value,n,i)}catch(o){a.e(o)}finally{a.f()}}else i[t]=n};return Object(i.useEffect)((function(){return window.addEventListener("keydown",r),window.addEventListener("keyup",r),function(){window.removeEventListener("keydown",r),window.removeEventListener("keyup",r)}})),[a,function(e,n){o(e,n,t.current)},function(e,t){o(e,t,n.current)},function(){Object.entries(n.current).forEach((function(e){var t=Object(s.a)(e,2),n=t[0],i=t[1];a(n)&&i()}))}]}(),c=Object(s.a)(l,4),u=c[1],h=c[2],f=c[3],d=Object(i.useState)(!1),m=Object(s.a)(d,2),p=m[0],g=m[1],v=Object(i.useState)(!1),b=Object(s.a)(v,2),x=b[0],y=b[1],j=Object(i.useState)(!1),C=Object(s.a)(j,2),w=C[0],O=C[1],k=Object(i.useState)(!1),_=Object(s.a)(k,2),T=_[0],R=_[1],S=function(e){e&&e.target.blur(),H.setPaused(!p),g(!p)},E=function(e){H.changeAnimationSpeed(e)},L=function(e){H.changeScale(e)},N=function(e){e&&e.target.blur(),H.randomize(),o()},A=function(e,t){e&&e.target.blur(),t?H.startRecording(60):H.stopRecording()},D=function(e){H.setRender3D(e),R(H.render3D)},z=function(e){D(!T)},G=function(e){e&&e.target.blur();var n=!x;y(n);var i=function e(n){(n.key&&"Escape"===n.key||"click"===n.type)&&(y(!1),window.removeEventListener("keydown",e),t.current.removeEventListener("click",e,!0))};n&&(t.current.addEventListener("click",i,!0),window.addEventListener("keydown",i))},M=[{keys:" ",action:function(e){S()},onHeld:!1,description:"Toggle pause"},{keys:"-",action:function(e){E(-.05)},onHeld:!0,description:"Decrease animation speed"},{keys:"+",action:function(e){E(.05)},onHeld:!0,description:"Increase animation speed"},{keys:"q",action:function(e){L(.02)},onHeld:!0,description:"Zoom out"},{keys:"e",action:function(e){L(-.02)},onHeld:!0,description:"Zoom in"},{keys:["ArrowLeft","a"],action:function(){P([-10,0])},onHeld:!0,description:"Move left"},{keys:["ArrowRight","d"],action:function(){P([10,0])},onHeld:!0,description:"Move right"},{keys:["ArrowUp","w"],action:function(){P([0,10])},onHeld:!0,description:"Move upwards"},{keys:["ArrowDown","s"],action:function(){P([0,-10])},onHeld:!0,description:"Move downwards"},{keys:"r",action:function(){N()},onHeld:!1,description:"Randomize controller parameters"},{keys:"c",action:function(e){X(e)},onHeld:!1,description:"Download current frame as PNG"},{keys:"n",action:function(){A()},onHeld:!1,description:"Start/stop recording"},{keys:"h",action:function(){G()},onHeld:!1,description:"Hide/show this help popup"},{keys:"3",action:function(){z()},onHeld:!1,description:"Toggle 3D mode"}],P=function(e){H.move(e)},F=function(e){H.changeScale(.1*Math.sign(e.deltaY),[e.clientX,e.clientY])},U=function(e){H.setAnchor([e.clientX,e.clientY])},B=function(e){H.liftAnchor()},V=function(e){H.anchorMove([e.clientX,e.clientY])},X=function(e){H.captureFrame((function(e){W(e,"canvas.png")}))};Object(i.useEffect)((function(){if(!H.isInitialized()){var e=t.current,i=n.current;if(!H.initialize(e,i,null))throw new Error("Warp controlleer failed to initialize");o(),H.start((function(){f()}))}})),Object(i.useLayoutEffect)((function(){var e=function(){H.handleResize()};return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}})),Object(i.useEffect)((function(){M.forEach((function(e){e.onHeld?h(e.keys,e.action):u(e.keys,e.action)})),t.current.addEventListener("wheel",F),t.current.addEventListener("mousedown",U),t.current.addEventListener("mouseup",B),t.current.addEventListener("mouseout",B),t.current.addEventListener("mousemove",V);var e=t.current;return function(){e.removeEventListener("wheel",F),e.removeEventListener("mousedown",U),e.removeEventListener("mouseup",B),e.removeEventListener("mouseout",B),e.removeEventListener("mousemove",V)}}));var q=Object(J.jsx)(Te,{name:"Capture Frame",onClick:X,description:"Save a single frame as a PNG image"},"captureButton"),Y=Object(J.jsx)(Te,{name:"Pause",activeName:"Play",onClick:S,state:p,description:"Pause/play the animation"},"pauseButton"),Q=Object(J.jsx)(Te,{name:"Enable 3D",activeName:"Disable 3D",onClick:z,state:T,description:"Toggle 3D view"},"threeDButton"),K=Object(J.jsx)(Te,{name:"Record",activeName:"Stop recording",onClick:A,description:"Record the animation (the recording will be a zipped archive of sequential PNG images"},"recordButton"),Z=Object(J.jsx)(Te,{name:"Import",onClick:function(e){r.current.click(),e.currentTarget.blur()},description:"Import a JSON file of settings",children:Object(J.jsx)("input",{ref:r,type:"file",style:{display:"none"},onChange:function(e){var t=e.target.files[0];if(t){var n=new FileReader;n.onload=function(e){H.importSettings(JSON.parse(e.target.result)),o()},n.readAsText(t)}},accept:"application/JSON"})},"importButton"),ne=Object(J.jsx)(Te,{name:"Export",onClick:function(e){!function(e,t){var n="data:text/json;charset=utf-8,"+encodeURIComponent(e);W(n,t)}(JSON.stringify(H.exportSettings(),null,2),"settings.json"),e.currentTarget.blur()},description:"Export a JSON file of the current settings"},"exportButton"),ie=Object(J.jsx)(Te,{name:"Randomize",onClick:N,description:"Randomize the settings"},"randomizeButton"),re=Object(J.jsx)(Te,{name:"?",activeName:"?",onClick:G,state:x,radius:35,description:"Display a help dialog with information about the application"},"helpButton"),ae=Object(J.jsx)(Te,{name:"Show Tooltips",activeName:"Hide Tooltips",onClick:function(e){e&&e.target.blur(),O(!w)},description:"Toggle tooltips"},"tooltipButton"),se=function(e,t,n,i){return Object(J.jsx)(Te,{name:t,hideName:!0,onClick:function(){window.open(n,"_blank")},description:i,children:Object(J.jsx)("img",{className:"icon-link",src:e,alt:t})},n)},le=se(ee,"Instagram","https://www.instagram.com/palmdrop/","Personal instagram profile, dedicated to generative art"),ce=se($,"Github","https://github.com/palmdrop/webgl-domain-warping-controller","The repository for this project"),ue=se(te,"Email","mailto:anton@exlex.se","Email, the most reliable way of reaching me"),he=Object(J.jsx)("div",{className:"separator-container",children:Object(J.jsx)("span",{className:"separator",children:"|"})},"separator"),fe=function(){var e={frameRate:{setterCallback:function(e){H.addUpdateCallback((function(){e(H.getFrameRate())}))}},avgFrameRate:{setterCallback:function(e){H.addUpdateCallback((function(){e(Math.round(H.getAverageFrameRate()))}))}},dimensions:{setterCallback:function(e){H.addResizeCallback((function(t){e(Math.round(t[0])+"x"+Math.round(t[1]))}))}}};return Object(J.jsx)(Se,{entries:e})},de={left:[re,he,Q,q,Y],center:[ie,he,Z,ne],right:[ae,le,ce,ue]},me=Object(J.jsx)("canvas",{className:"canvas"+(T?" canvas--hidden":""),ref:t}),pe=Object(J.jsx)("canvas",{className:"canvas"+(T?"":" canvas--hidden"),ref:n});return Object(J.jsxs)("div",{className:"canvas-container",children:[H.isInitialized()?Object(J.jsx)(_e,{categories:function(){var e=function(e,t,n,i,r,a){return{attributes:H.getAttributes(e),getter:function(t){return H.getValue(e,t)},setter:function(t,n){return H.updateValue(e,t,n)},default:function(t){return H.getDefault(e,t)},controller:e,separator:".",before:t,after:n,name:i,description:r,onClickCallback:a}};return{texture:e("TXC",null,null,"Texture","Settings for the overall texture, warp effect and animation"),color:e("CC",null,null,"Color","Settings for hue, saturation, brightness, color balance, and so on"),render:e("RC",fe(),[q,Y,K],"Render","Settings for resolution, multisampling, recording, and so on"),three:e("TDC",null,null,"3D","Settings for 3D mode",(function(e){e||D(!0)}))}}(),topbar:de,showTooltip:w}):"",me,pe,Object(J.jsx)(oe,{mainTitle:"Surfaces",visibility:x,shortcuts:M,onCloseCallback:function(){return G()}})]})};o.a.render(Object(J.jsx)(r.a.StrictMode,{children:Object(J.jsx)(Ee,{})}),document.getElementById("root"))},64:function(e,t,n){},84:function(e,t,n){},85:function(e,t,n){},87:function(e,t,n){},88:function(e,t,n){},89:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){},96:function(e,t,n){},97:function(e,t,n){},98:function(e,t,n){},99:function(e,t,n){}},[[105,1,2]]]);
//# sourceMappingURL=main.c47c5815.chunk.js.map